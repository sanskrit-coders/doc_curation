\documentclass[12pt,openany]{book}
\usepackage{fontspec}
\usepackage{ucharclasses}
\usepackage{hyperref}
\usepackage{xcolor}
\usepackage{titlesec}
\usepackage{etoolbox}

__PAPER_GEOMETRY__

\makeatletter
% Force the 'plain' page style (used by Parts/Chapters) to be the same as 'headings'
\let\ps@plain\ps@headings
\makeatother
\pagestyle{headings}

% Apply sloppy globally
\sloppy 

% --- 1. FONT CONFIGURATION ---
\setmainfont{Noto Sans}[Script=Latin,Renderer=HarfBuzz]

\newfontfamily\devanagarifont{Siddhanta}[
  Script=Devanagari,
  Renderer=HarfBuzz,
  Scale=1.3,
  ItalicFont={Siddhanta},
  ItalicFeatures={FakeSlant=0.2},
  BoldItalicFont={Siddhanta},
  BoldItalicFeatures={FakeSlant=0.2, Weight=Bold}
]

% TODO - ᳓ tofued.
\setTransitionsForDevanagari{\devanagarifont}{\rmfamily}
\setTransitionsForDevanagariExtended{\devanagarifont}{\rmfamily}
\setTransitionsForDevanagariExtendedA{\devanagarifont}{\rmfamily}
\setTransitionsForVedicExtensions{\devanagarifont}{\rmfamily}
\setTransitionsFor{DevanagariDanDa}{\devanagarifont}{\rmfamily}


% Define a font that contains the arrow symbol (Noto Sans Symbols is best)
\newfontfamily\symbolfont{Noto Sans Symbols}[Renderer=HarfBuzz]

% FIX: Use newunicodechar for arrows instead of ucharclasses transitions
\usepackage{newunicodechar}
\newunicodechar{᳓}{{\devanagarifont ᳓}} % Force Vedic Sign Nihshvasa to use Devanagari font
\newunicodechar{→}{{\symbolfont →}}
\newunicodechar{←}{{\symbolfont ←}}
\newunicodechar{↔}{{\symbolfont ↔}}

\emergencystretch=1em % Allows TeX to find better line breaks in tight spots

% --- 2. DEVANAGARI NUMERALS & HIERARCHICAL NUMBERING ---
\makeatletter
\newcommand{\devanagarinum}[1]{%
  \expandafter\@devanagarinum\number#1\@nil
}
\def\@devanagarinum#1{%
  \ifx#1\@nil\else
    \ifcase#1 ०\or १\or २\or ३\or ४\or ५\or ६\or ७\or ८\or ९\fi
    \expandafter\@devanagarinum
  \fi
}

% Hierarchical numbering: part.chapter.section.subsection.subsubsection
\renewcommand{\thepage}{\devanagarinum{\value{page}}}
\renewcommand{\thepart}{\devanagarinum{\value{part}}}
\renewcommand{\thechapter}{\thepart.\devanagarinum{\value{chapter}}}
\renewcommand{\thesection}{\thechapter.\devanagarinum{\value{section}}}
\renewcommand{\thesubsection}{\thesection.\devanagarinum{\value{subsection}}}
\renewcommand{\thesubsubsection}{\thesubsection.\devanagarinum{\value{subsubsection}}}
\makeatother

% --- 3. REMOVE PAGE BREAKS & REDUCE SPACING ---
\makeatletter
% Instead of 'relax', use 'par'. This ensures a new line but NO new page.
\let\cleardoublepage\par
\let\clearpage\par
\let\newpage\par

% Redefine Part and Chapter to act like standard sections (no new pages)
\renewcommand\part{\@startsection{part}{0}{\z@}%
  {-2pt \@plus -1ex \@minus -.2ex}%
  {2pt \@plus.2ex}%
  {\normalfont\normalsize\bfseries}}

\renewcommand\chapter{\@startsection{chapter}{1}{\z@}%
  {-2pt \@plus -1ex \@minus -.2ex}%
  {2pt \@plus.2ex}%
  {\normalfont\normalsize\bfseries}}
\makeatother

% Format Titles Appearance
\titleformat{\part}[hang]{\normalfont\normalsize\bfseries}{\thepart}{1em}{}
\titleformat{\chapter}[hang]{\normalfont\normalsize\bfseries}{\thechapter}{1em}{}
\titleformat{\section}[hang]{\normalfont\normalsize\bfseries}{\thesection}{1em}{}
\titleformat{\subsection}[hang]{\normalfont\normalsize\bfseries}{\thesubsection}{1em}{}
\titleformat{\subsubsection}[hang]{\normalfont\normalsize\bfseries}{\thesubsubsection}{1em}{}

% Tight Spacing
\titlespacing*{\part}{0pt}{2pt}{2pt}
\titlespacing*{\chapter}{0pt}{2pt}{2pt}
\titlespacing*{\section}{0pt}{2pt}{2pt}
\titlespacing*{\subsection}{0pt}{2pt}{2pt}
\titlespacing*{\subsubsection}{0pt}{2pt}{2pt}

% Suppress "Part" and "Chapter" labels
\renewcommand{\partname}{}
\renewcommand{\chaptername}{}

% --- 4. TABLE OF CONTENTS ---
\usepackage{tocloft}
\renewcommand{\contentsname}{Contents}
\renewcommand{\cftpartfont}{\bfseries\normalsize}
\renewcommand{\cftchapfont}{\bfseries\normalsize}
\renewcommand{\cftsecfont}{\bfseries\normalsize}
% Remove the page breaks before TOC
\patchcmd{\tableofcontents}{\clearpage}{}{}{}
\patchcmd{\tableofcontents}{\newpage}{}{}{}

% Adjust TOC width to accommodate long hierarchical numbers (e.g. १.१.१.१)
\setlength{\cftchapnumwidth}{4em}
\setlength{\cftsecnumwidth}{5em}
\setlength{\cftsubsecnumwidth}{6em}
\setlength{\cftsubsubsecnumwidth}{7em}
% Inline comment style
\newcommand{\inlinecomment}[1]{%
  {\color[HTML]{1B1B1B}\textit{\small\raisebox{-0.3ex}{#1}}}%
}

__METADATA__

\begin{document}
\tableofcontents
\vspace{2em} 

__LATEX_BODY__

\end{document}